# IIC通信原理
***
**TTL串口**使用**两根线**来**通信**，**一根线**来**共地**
#### TTL：
- RX
- TX
- GND


**IIC通信**也是**一根线共地**，但是只有**一根线**来**通信**，剩下的**一根线**是**时钟线**

#### IIC：
- **SDA**（数据线）
- **SCL**（时钟线）
- **GND**

#### IIC的主从模式：
IIC一个时刻中只能向一个方向发送信息，所以使用主从模式来避免冲突。

一台设备为**主机**，另一台（多台）为**从机**，只能由主机先发起通信，从机作答复。

这种特性使得IIC能够同时连接多台设备，像这样的支持多设备的协议称为**总线协议**。

连接到同一个IIC接口的外设都有唯一的**设备地址**。

主机若要向某个从机通信，首先向从机发送其对应的从机地址，这是目标从机接收到了自己的地址就会答复，同一条总线上的外设没有接收到自己的地址就不会答复。

在**TTL串口**中：通信的双方先约定好通信的速率，也就是**比特率**，双方按照这一速度，在合适的时机去设定或者读取数据线上的电平信号。我们称之为**异步模式**，因为他们对何时去读取信息依靠各自的时钟，好处就是灵活便捷，缺点是双方必须保证各自的系统时钟是精确的。

而在**IIC**中：为了照顾小外设没有精确晶振提供时钟信号的情况下，多出一条**SCL时钟线**，使用主机的时钟，统一向外设提供时钟信号，是**同步模式**。

#### IIC的通信实例：
IIC的数据线和时钟线都有上拉电阻进行上拉

**未开始通信时：**数据线和时钟线都处于高电平。

**开始通信时：**在时钟线是高电平时，将数据下拉，作为一个开始信号，接着主机就会在时钟线上输出脉冲信号，主从机都依靠这个信号来同步对数据线的读写。

**时钟线**处于**低电平**时，**主机**在数据线中**写入**信号，**时钟线**处于**高电平**时，**从机读取**信号。

在发送地址的时候，最后一位是用来区分读写的，所以发送的地址可能比真正的地址多1。

主机写，从机读的操作执行完八次后，一个字节的数据就发送完成，按照IIC协议，数据的接收方需要发送一个**ACK应答信号**，确认自己已经收到数据。

**ACK信号**：在时钟线低电平时，由接收方将数据线拉低一下。

